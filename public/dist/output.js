!function e(t,r,o){function n(a,u){if(!r[a]){if(!t[a]){var s="function"==typeof require&&require;if(!u&&s)return s(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[a]={exports:{}};t[a][0].call(c.exports,function(e){var r=t[a][1][e];return n(r?r:e)},c,c.exports,e,t,r,o)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)n(o[a]);return n}({1:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=e("./routers/router"),a=o(i),u=e("./models/user"),s=(o(u),e("./collections/users")),l=(o(s),function c(){n(this,c),Backbone.$.ajaxSetup({headers:{Authorization:"Bearer 4ec7d609-bdf1-4de4-b2e6-4ac59f61ac40"}}),new a["default"]({$rootEl:$("#main"),$navBar:$("#nav")}),Backbone.history.start()});$(function(){function e(e,t){return $.Deferred(function(r){$(t).load(e,function(){r.resolve()})}).promise()}Array.prototype.remove=function(e,t){var r=this.slice((t||e)+1||this.length);return this.length=0>e?this.length+e:e,this.push.apply(this,r)};var t=[];t.push(e("templates/user_show.jst.ejs","#user-show-template-holder")),t.push(e("templates/user_profile.jst.ejs","#user-prof-template-holder")),t.push(e("templates/users_index.jst.ejs","#users-index-template-holder")),t.push(e("templates/user_item.jst.ejs","#user-item-template-holder")),t.push(e("templates/nav_bar.jst.ejs","#nav-template-holder")),t.push(e("templates/groups_modal.jst.ejs","#groups-modal-template-holder")),t.push(e("templates/groups_index.jst.ejs","#groups-index-template-holder")),$.when.apply(void 0,t).done(function(){new l})})},{"./collections/users":3,"./models/user":5,"./routers/router":6}],2:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(e,t,r){for(var o=!0;o;){var n=e,i=t,a=r;u=l=s=void 0,o=!1,null===n&&(n=Function.prototype);var u=Object.getOwnPropertyDescriptor(n,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var l=Object.getPrototypeOf(n);if(null===l)return void 0;e=l,t=i,r=a,o=!0}},u=e("../models/group"),s=o(u),l=function(e){function t(){n(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.url="http://b2b-server2-staging.elasticbeanstalk.com/api/sync",this.model=s["default"]}return i(t,e),t}(Backbone.Collection);r["default"]=l,t.exports=r["default"]},{"../models/group":4}],3:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(e,t,r){for(var o=!0;o;){var n=e,i=t,a=r;u=l=s=void 0,o=!1,null===n&&(n=Function.prototype);var u=Object.getOwnPropertyDescriptor(n,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var l=Object.getPrototypeOf(n);if(null===l)return void 0;e=l,t=i,r=a,o=!0}},u=e("../models/user"),s=o(u),l=function(e){function t(){n(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.url="http://b2b-server2-staging.elasticbeanstalk.com/api/sync",this.model=s["default"]}return i(t,e),t}(Backbone.Collection);r["default"]=l,t.exports=r["default"]},{"../models/user":5}],4:[function(e,t,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),a=function(e,t,r){for(var o=!0;o;){var n=e,i=t,a=r;u=l=s=void 0,o=!1,null===n&&(n=Function.prototype);var u=Object.getOwnPropertyDescriptor(n,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var l=Object.getPrototypeOf(n);if(null===l)return void 0;e=l,t=i,r=a,o=!0}},u=function(e){function t(){o(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return n(t,e),i(t,[{key:"urlRoot",value:function(){return"http://b2b-server2-staging.elasticbeanstalk.com/api/admin/groups"}},{key:"update",value:function(){var e="http://b2b-server2-staging.elasticbeanstalk.com/api/admin/groups/";e+=this.get("_id");var t=JSON.stringify({name:name});$.ajax({type:"PUT",dataType:"json",contentType:"application/json",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer 4ec7d609-bdf1-4de4-b2e6-4ac59f61ac40")},data:t,url:e,success:this.renderSavedEdit.bind(this),error:function(e,t,r){alert("Errr... this is awkward. Something's wrong \n"+t+": "+r)}})}}]),t}(Backbone.Model);r["default"]=u,t.exports=r["default"]},{}],5:[function(e,t,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),a=function(e,t,r){for(var o=!0;o;){var n=e,i=t,a=r;u=l=s=void 0,o=!1,null===n&&(n=Function.prototype);var u=Object.getOwnPropertyDescriptor(n,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var l=Object.getPrototypeOf(n);if(null===l)return void 0;e=l,t=i,r=a,o=!0}},u=function(e){function t(){o(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return n(t,e),i(t,[{key:"urlRoot",value:function(){return"http://b2b-server2-staging.elasticbeanstalk.com/api/user"}},{key:"create",value:function(e,t){var r="http://b2b-server2-staging.elasticbeanstalk.com/api/admin/users";$.ajax({type:"POST",dataType:"json",contentType:"application/json",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer 4ec7d609-bdf1-4de4-b2e6-4ac59f61ac40")},url:r,data:e,success:t,error:function(e,t,r){alert("Errr... this is awkward. Something's wrong \n"+t+": "+r)}})}},{key:"update",value:function(e,t){var r="http://b2b-server2-staging.elasticbeanstalk.com/api/admin/users/";r+=this.get("_id"),$.ajax({type:"PUT",dataType:"json",contentType:"application/json",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer 4ec7d609-bdf1-4de4-b2e6-4ac59f61ac40")},url:r,data:e,success:t,error:function(e,t,r){alert("Errr... this is awkward. Something's wrong \n"+t+": "+r)}})}}]),t}(Backbone.Model);r["default"]=u,t.exports=r["default"]},{}],6:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),u=function(e,t,r){for(var o=!0;o;){var n=e,i=t,a=r;u=l=s=void 0,o=!1,null===n&&(n=Function.prototype);var u=Object.getOwnPropertyDescriptor(n,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var l=Object.getPrototypeOf(n);if(null===l)return void 0;e=l,t=i,r=a,o=!0}},s=e("../views/nav_bar"),l=o(s),c=e("../utils/sync_helper"),p=o(c),f=e("../models/user"),d=o(f),v=e("../views/user_show"),h=o(v),y=e("../views/user_new"),b=o(y),g=e("../views/profile_show"),m=o(g),w=e("../views/users_index"),_=o(w),O=e("../views/groups_index"),k=o(O),j=e("../views/groups_modal"),P=o(j),x=function(e){function t(e){n(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.$rootEl=e.$rootEl,this.$navBar=e.$navBar,this.syncHelper=new p["default"],this.routes={"":"profile",profile:"profile",users:"users","users/new":"userNew","users/:id":"userShow",groups:"groups"},this._bindRoutes()}return i(t,e),a(t,[{key:"profile",value:function(){var e=new d["default"];e.fetch(),$.when(this.syncHelper.syncData()).done(function(t){var r=new m["default"]({model:e,collections:t});this.swapViews(r,"profile");var o=new P["default"]({collection:t.groups});$(".groups-modal").html(o.render().$el)}.bind(this))}},{key:"users",value:function(){$.when(this.syncHelper.syncData()).done(function(e){var t=new _["default"]({collections:e});this.swapViews(t,"users");var r=new P["default"]({collection:e.groups});$(".groups-modal").html(r.render().$el)}.bind(this))}},{key:"userShow",value:function(e){$.when(this.syncHelper.syncData()).done(function(t){var r=new d["default"](this.getUser(e,t)),o=new h["default"]({model:r,collections:t}),n=new P["default"]({collection:t.groups});$(".groups-modal").html(n.render().$el),this.swapViews(o,"users")}.bind(this))}},{key:"userNew",value:function(){var e=new d["default"];$.when(this.syncHelper.syncData()).done(function(t){var r=new b["default"]({model:e,collections:t}),o=new P["default"]({collection:t.groups});$(".groups-modal").html(o.render().$el),this.swapViews(r,"users")}.bind(this))}},{key:"groups",value:function(e){$.when(this.syncHelper.syncData()).done(function(e){var t=new k["default"]({collection:e.groups});this.swapViews(t,"groups")}.bind(this))}},{key:"swapViews",value:function(e,t){this._nav=new l["default"]({page:t}),this.$navBar.html(this._nav.render().$el),this._currentView&&this._currentView.remove(),this._currentView=e,this.$rootEl.html(e.render().$el)}},{key:"getUser",value:function(e,t){for(var r=t.users,o=0;o<r.length;o++)if(r[o]._id===e)return r[o]}}]),t}(Backbone.Router);r["default"]=x,t.exports=r["default"]},{"../models/user":5,"../utils/sync_helper":7,"../views/groups_index":9,"../views/groups_modal":10,"../views/nav_bar":11,"../views/profile_show":12,"../views/user_new":14,"../views/user_show":15,"../views/users_index":16}],7:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),a=e("../collections/users"),u=o(a),s=e("../collections/groups"),l=o(s),c=function(){function e(){n(this,e)}return i(e,[{key:"syncData",value:function(e){var t="http://b2b-server2-staging.elasticbeanstalk.com/api/sync";return $.ajax({type:"GET",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer 4ec7d609-bdf1-4de4-b2e6-4ac59f61ac40")},url:t,success:e})}},{key:"getUsers",value:function(e){var t=new u["default"];return t.add(e.users),t}},{key:"getGroups",value:function(e){var t=new l["default"];return t.add(e.groups),t}}]),e}();r["default"]=c,t.exports=r["default"]},{"../collections/groups":2,"../collections/users":3}],8:[function(e,t,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),a=function(e,t,r){for(var o=!0;o;){var n=e,i=t,a=r;u=l=s=void 0,o=!1,null===n&&(n=Function.prototype);var u=Object.getOwnPropertyDescriptor(n,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var l=Object.getPrototypeOf(n);if(null===l)return void 0;e=l,t=i,r=a,o=!0}},u=function(e){function t(e){o(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.model=e.model,this.listenTo(this.model,"sync",this.render)}return n(t,e),i(t,[{key:"render",value:function(){var e='<li class="profile__group-item" id="'+this.model.get("_id");return e+='"> <div class="del-x">x</div> '+this.model.escape("name")+"</li>",this.$el.html(e),this}}]),t}(Backbone.View);r["default"]=u,t.exports=r["default"]},{}],9:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),u=function(e,t,r){for(var o=!0;o;){var n=e,i=t,a=r;u=l=s=void 0,o=!1,null===n&&(n=Function.prototype);var u=Object.getOwnPropertyDescriptor(n,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var l=Object.getPrototypeOf(n);if(null===l)return void 0;e=l,t=i,r=a,o=!0}},s=e("../collections/groups"),l=o(s),c=function(e){function t(e){n(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.collection=new l["default"],e.collection&&this.collection.add(e.collection),this.template=_.template($("#groups-index-template").html()),this.events={"click .checkbox-propre":"selectGroup","submit #new-group-form":"addGroup","submit #edit-group-form":"saveEdit","click .index__options__delete":"deleteGroups","click .index__options__edit":"renderEdit"},this.count=this.groupCount(),Backbone.View.apply(this)}return i(t,e),a(t,[{key:"render",value:function(){return this.$el.html(this.template({count:this.count})),this.collection.each(function(e){if(!e.get("deletedAt")){var t='<li class="profile__group-item" id="'+e.get("_id");t+='"> <div class="checkbox-propre"></div> <div class="group-name">'+e.escape("name")+"</div></li>",this.$el.find(".groups-index").append(t)}}.bind(this)),this}},{key:"selectGroup",value:function(e){$(e.currentTarget).parent().toggleClass("active")}},{key:"addGroup",value:function(e){e.preventDefault();var t=$(e.currentTarget).find("input").val();this.createGroup(t)}},{key:"createGroup",value:function(e){var t="http://b2b-server2-staging.elasticbeanstalk.com/api/admin/groups/",r=JSON.stringify({name:e});$.ajax({type:"POST",dataType:"json",contentType:"application/json",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer 4ec7d609-bdf1-4de4-b2e6-4ac59f61ac40")},data:r,url:t,success:this.refresh.bind(this),error:function(e,t,r){alert("Errr... this is awkward. Something's wrong \n"+t+": "+r)}})}},{key:"deleteGroups",value:function(){var e=this.$el.find("li.active");e.each(function(e,t){var r=t.id;this.deleteGroup(t.id),this.$el.find("li#"+r).remove(),this.count-=1,this.$el.find(".index__count").html(this.count)}.bind(this))}},{key:"deleteGroup",value:function(e){var t="http://b2b-server2-staging.elasticbeanstalk.com/api/admin/groups/"+e;$.ajax({type:"DELETE",dataType:"json",contentType:"application/json",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer 4ec7d609-bdf1-4de4-b2e6-4ac59f61ac40")},url:t,error:function(e,t,r){alert("Errr... this is awkward. Something's wrong \n"+t+": "+r)}})}},{key:"renderEdit",value:function(e){var t=this.$el.find("li.active");t.each(function(e,t){var r=$(t).find(".group-name");if(!r.has("form").length){var o='<form id="edit-group-form" data-id="'+t.id+'"><input class="group-edit-input" value="';o+=r.html()+'"></form><button></button>',r.html(o);var n=$(t).find(".group-edit-input");n.attr("size",n.val().length)}}.bind(this))}},{key:"saveEdit",value:function(e){e.preventDefault();var t=$(e.currentTarget).find("input").val(),r=e.currentTarget.getAttribute("data-id"),o="http://b2b-server2-staging.elasticbeanstalk.com/api/admin/groups/"+r,n=JSON.stringify({name:t});$.ajax({type:"PUT",dataType:"json",contentType:"application/json",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer 4ec7d609-bdf1-4de4-b2e6-4ac59f61ac40")},data:n,url:o,success:this.renderSavedEdit.bind(this),error:function(e,t,r){alert("Errr... this is awkward. Something's wrong \n"+t+": "+r)}})}},{key:"renderSavedEdit",value:function(e){var t=this.$el.find("li#"+e.data._id);t.find(".group-name").html(e.data.name),t.removeClass("active")}},{key:"refresh",value:function(e){var t='<li class="profile__group-item" id="'+e.data._id;t+='"> <div class="checkbox-propre"></div> '+e.data.name+"</li>",this.$el.find(".groups-index").append(t),this.count+=1,this.$el.find(".index__count").html(this.count)}},{key:"groupCount",value:function(){var e=0;return this.collection.each(function(t){t.get("deletedAt")||(e+=1)}),e}}]),t}(Backbone.View);r["default"]=c,t.exports=r["default"]},{"../collections/groups":2}],10:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),u=function(e,t,r){for(var o=!0;o;){var n=e,i=t,a=r;u=l=s=void 0,o=!1,null===n&&(n=Function.prototype);var u=Object.getOwnPropertyDescriptor(n,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var l=Object.getPrototypeOf(n);if(null===l)return void 0;e=l,t=i,r=a,o=!0}},s=e("../collections/groups"),l=o(s),c=function(e){function t(e){n(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.collection=new l["default"],e.collection&&this.collection.add(e.collection),this.template=_.template($("#groups-modal-template").html()),this.events={"click .checkbox-propre":"selectGroup"},Backbone.View.apply(this)}return i(t,e),a(t,[{key:"render",value:function(){return this.$el.html(this.template()),this.collection.each(function(e){if(!e.get("deletedAt")){var t='<li class="profile__group-item" id="'+e.get("_id");t+='"> <div class="checkbox-propre"></div> '+e.escape("name")+"</li>",this.$el.find("ul").append(t)}}.bind(this)),this}},{key:"selectGroup",value:function(e){$(e.currentTarget).parent().toggleClass("active")}}]),t}(Backbone.View);r["default"]=c,t.exports=r["default"]},{"../collections/groups":2}],11:[function(e,t,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),a=function(e,t,r){for(var o=!0;o;){var n=e,i=t,a=r;u=l=s=void 0,o=!1,null===n&&(n=Function.prototype);var u=Object.getOwnPropertyDescriptor(n,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var l=Object.getPrototypeOf(n);if(null===l)return void 0;e=l,t=i,r=a,o=!0}},u=function(e){function t(e){o(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.page=e.page,this.template=_.template($("#nav-template").html()),this.events={"click ul":"changePage"}}return n(t,e),i(t,[{key:"render",value:function(){var e="#navbar-"+this.page;return this.$el.html(this.template()),this.$el.find("li").removeClass("active"),this.$el.find(e).addClass("active"),this.clickEvents(),this}},{key:"changePage",value:function(e){var t=$(e.currentTarget),r=t.attr("id").split("-")[1];Backbone.history.navigate("#/"+r,{trigger:!0})}},{key:"clickEvents",value:function(){this.$el.on("click","li",this.changePage)}}]),t}(Backbone.View);r["default"]=u,t.exports=r["default"]},{}],12:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),u=function(e,t,r){for(var o=!0;o;){var n=e,i=t,a=r;u=l=s=void 0,o=!1,null===n&&(n=Function.prototype);var u=Object.getOwnPropertyDescriptor(n,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var l=Object.getPrototypeOf(n);if(null===l)return void 0;e=l,t=i,r=a,o=!0}},s=e("../collections/groups"),l=o(s),c=e("./group_item"),p=(o(c),e("./user_show")),f=o(p),d=function(e){function t(e){n(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.model=e.model;var r=this;this.collections=e.collections,this.groups=new l["default"],e.collections&&this.groups.add(e.collections.groups),this.template=_.template($("#user-profile-template").html()),this.listenTo(this.model,"sync",this.render),this.events={"submit #password-form":"updatePassowrd","click #dropzone-prof-pic":"clearPicZone"},Dropzone.options.dropzoneProfPic={maxFilesize:4096,accept:function(e,t){$(e.previewTemplate).find(".dz-success-mark").css("display","none"),$(e.previewTemplate).find(".dz-error-mark").css("display","none"),$(".profile__pic-words").append('<div class="save-pic">Save new photo</div>'),$(".save-pic").on("click",r.savePicture.bind(r))}},Backbone.View.apply(this)}return i(t,e),a(t,[{key:"render",value:function(){this.$el.html(this.template({user:this.model}));var e=new f["default"]({model:this.model,collections:this.collections,profile:!0});return this.$el.find(".profile-user-show").append(e.render().$el),this.setDropzone(),this}},{key:"setDropzone",value:function(){this.profDropzone||($("#dropzone-prof-pic").length>0?(this.profDropzone=new Dropzone("#dropzone-prof-pic",{url:"#",autoProcessQueue:!1}),clearInterval(this.findDropElement)):this.findDropElement=window.setInterval(function(){this.setDropzone()}.bind(this),200))}},{key:"savePicture",value:function(){var e=$(".dz-image").children(),t=e.attr("src"),r=JSON.stringify({picture:t});this.model.update(r,this.pictureSaved.bind(this))}},{key:"updatePassowrd",value:function(e){if(e.preventDefault(),!$(".user-groups-modal").hasClass("active")){var t=$(e.currentTarget).serializeJSON().user,r=JSON.stringify(t);this.model.update(r,this.render.bind(this))}}},{key:"pictureSaved",value:function(e){this.$el.find(".profile__pic").attr("src",e.data.picture),this.model.set({picture:e.data.picture}),this.clearPicZone()}},{key:"clearPicZone",value:function(e){e&&"dropzone-prof-pic"!==e.target.id||(this.$el.find("#dropzone-prof-pic").children().remove(),this.$el.find(".save-pic").remove())}}]),t}(Backbone.View);r["default"]=d,t.exports=r["default"]},{"../collections/groups":2,"./group_item":8,"./user_show":15}],13:[function(e,t,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),a=function(e,t,r){for(var o=!0;o;){var n=e,i=t,a=r;u=l=s=void 0,o=!1,null===n&&(n=Function.prototype);var u=Object.getOwnPropertyDescriptor(n,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var l=Object.getPrototypeOf(n);if(null===l)return void 0;e=l,t=i,r=a,o=!0}},u=function(e){function t(e){o(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.model=e.model,this.groups=e.groups,this.template=_.template($("#user-item-template").html()),this.events={"click .user-item__checkbox":"selectItem","click .user-item__groups__edit":"editUser"},this.listenTo(this.model,"sync",this.render),Backbone.View.apply(this)}return n(t,e),i(t,[{key:"render",value:function(){this.$el.html(this.template({user:this.model}));var e=0;return this.model.get("groupIds").forEach(function(t){var r=this.groupById(t);if(r){var o="";o=0===e?" "+r.escape("name"):", "+r.escape("name"),e+=1,this.$el.find(".user-item__groups__text").append(o)}}.bind(this)),this}},{key:"groupById",value:function(e){var t=null;return this.groups.each(function(r){return r.get("deletedAt")?void 0:r.get("_id")===e?(t=r,r):void 0}),t}},{key:"selectItem",value:function(e){var t=$(e.currentTarget);t.find("div").toggleClass("active")}},{key:"editUser",value:function(e){Backbone.history.navigate("#/users/"+this.model.get("_id"),{trigger:!0})}}]),t}(Backbone.View);r["default"]=u,t.exports=r["default"]},{}],14:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),u=function(e,t,r){for(var o=!0;o;){var n=e,i=t,a=r;u=l=s=void 0,o=!1,null===n&&(n=Function.prototype);var u=Object.getOwnPropertyDescriptor(n,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var l=Object.getPrototypeOf(n);if(null===l)return void 0;e=l,t=i,r=a,o=!0}},s=e("../collections/groups"),l=o(s),c=e("./group_item"),p=(o(c),e("./user_show")),f=o(p),d=function(e){function t(e){n(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.model=e.model,this.groups=new l["default"],e.collections&&this.groups.add(e.collections.groups),this.template=_.template($("#user-show-template").html()),this.events={"submit form":"create"},Backbone.View.apply(this)}return i(t,e),a(t,[{key:"updateInfo",value:function(){}},{key:"create",value:function(e){e.preventDefault();var t=$(e.currentTarget).serializeJSON().user;t.groupIds=this.model.get("groupIds");var r=JSON.stringify(t);this.model.create(r,this.newPage.bind(this))}},{key:"newPage",value:function(e){Backbone.history.navigate("#/users/"+e.data._id,{trigger:!0})}}]),t}(f["default"]);r["default"]=d,t.exports=r["default"]},{"../collections/groups":2,"./group_item":8,"./user_show":15}],15:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),u=function(e,t,r){for(var o=!0;o;){var n=e,i=t,a=r;u=l=s=void 0,o=!1,null===n&&(n=Function.prototype);var u=Object.getOwnPropertyDescriptor(n,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var l=Object.getPrototypeOf(n);if(null===l)return void 0;e=l,t=i,r=a,o=!0}},s=e("../utils/sync_helper"),l=(o(s),e("../collections/groups")),c=o(l),p=e("./group_item"),f=o(p),d=e("./groups_modal"),v=(o(d),function(e){function t(e){n(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.model=e.model,this.groups=new c["default"],
this.profile=e.profile,e.collections&&this.groups.add(e.collections.groups),this.template=_.template($("#user-show-template").html()),this.listenTo(this.model,"sync",this.render),this.events={"submit #normal-form":"updateInfo","click .del-x":"deleteGroup","click #groups-button":"groupsModal","keyup input":"storeFormData"},Backbone.View.apply(this)}return i(t,e),a(t,[{key:"storeFormData",value:function(e){var t=$(e.currentTarget).val(),r=e.currentTarget.name.slice(5,-1);this.model.attributes[r]=t}},{key:"render",value:function(){return this.$el.html(this.template({user:this.model,profile:this.profile})),this.model.get("groupIds")?(this.model.get("groupIds").forEach(function(e){var t=this.groupById(e);if(t){var r=new f["default"]({model:t});this.$el.find(".user-show__groups-list").append(r.render().$el)}}.bind(this)),this):this}},{key:"groupById",value:function(e){var t=null;return this.groups.each(function(r){return r.get("deletedAt")?void 0:r.get("_id")===e?(t=r,r):void 0}),t}},{key:"updateInfo",value:function(e){if(e.preventDefault(),!this.inModal){var t=$(e.currentTarget).serializeJSON().user;t.groupIds=this.model.get("groupIds");var r=JSON.stringify(t);this.model.update(r,this.refresh.bind(this))}}},{key:"refresh",value:function(e){alert("Succès!"),this.model.set(e.data),this.render()}},{key:"deleteGroup",value:function(e){for(var t=$(e.currentTarget).parent(),r=t.attr("id"),o=this.model.get("groupIds"),n=0;n<o.length;n++)if(o[n]==r){this.model.attributes.groupIds.remove(n);break}t.remove()}},{key:"groupsModal",value:function(){this.inModal||(this.inModal=!0,this.toggleBlur(),$(".user-groups-button").on("click",this.addGroups.bind(this)))}},{key:"addGroups",value:function(e){var t=$(e.currentTarget).parent().find("li.active");t.each(function(e,t){this.model.attributes.groupIds?this.model.attributes.groupIds.indexOf(t.id)<0&&this.model.attributes.groupIds.push(t.id):this.model.attributes.groupIds=[t.id]}.bind(this)),this.toggleBlur(),this.inModal=!1,$(".user-groups-button").off("click"),this.render()}},{key:"toggleBlur",value:function(){$(".blur-wrapper").toggleClass("active"),$(".blur-wrapper-sub").toggleClass("active"),$(".user-groups-modal").toggleClass("active"),$(".user-groups-modal").find("li.active").removeClass("active")}}]),t}(Backbone.View));r["default"]=v,t.exports=r["default"]},{"../collections/groups":2,"../utils/sync_helper":7,"./group_item":8,"./groups_modal":10}],16:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),u=function(e,t,r){for(var o=!0;o;){var n=e,i=t,a=r;u=l=s=void 0,o=!1,null===n&&(n=Function.prototype);var u=Object.getOwnPropertyDescriptor(n,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var l=Object.getPrototypeOf(n);if(null===l)return void 0;e=l,t=i,r=a,o=!0}},s=e("../collections/groups"),l=o(s),c=e("../collections/users"),p=o(c),f=e("./user_item"),d=o(f),v=function(e){function t(e){n(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.model=e.model,this.groups=new l["default"],this.collection=new p["default"],e.collections&&this.collection.add(e.collections.users),e.collections&&this.groups.add(e.collections.groups),this.template=_.template($("#users-index-template").html()),this.count=this.userCount(),this.events={"click .index__options__add":"addUser","click .index__options__delete":"deleteUsers","click .index__options__edit":"editUser","click .check-all":"checkAll"},Backbone.View.apply(this)}return i(t,e),a(t,[{key:"render",value:function(){return this.$el.html(this.template({count:this.count})),this.collection.forEach(function(e){if(!e.get("deletedAt")){var t=new d["default"]({model:e,groups:this.groups});this.$el.find(".users-index").append(t.render().$el)}}.bind(this)),this}},{key:"addUser",value:function(){Backbone.history.navigate("#/users/new",{trigger:!0})}},{key:"deleteUsers",value:function(){var e=this.$el.find(".active");e.each(function(e,t){var r=t.parentElement.id;this.deleteUser(r),this.$el.find("ul#"+r).remove(),this.count-=1,this.$el.find(".index__count").html(this.count)}.bind(this))}},{key:"deleteUser",value:function(e){var t="http://b2b-server2-staging.elasticbeanstalk.com/api/admin/users/"+e;$.ajax({type:"DELETE",dataType:"json",contentType:"application/json",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer 4ec7d609-bdf1-4de4-b2e6-4ac59f61ac40")},url:t,error:function(e,t,r){alert("Errr... this is awkward. Something's wrong \n"+t+": "+r)}})}},{key:"editUser",value:function(){var e=this.$el.find(".active"),t=e.first().parent();t.attr("id")&&Backbone.history.navigate("#/users/"+t.attr("id"))}},{key:"checkAll",value:function(){this.$el.find(".checkbox-propre").toggleClass("active")}},{key:"userCount",value:function(){var e=0;return this.collection.each(function(t){t.get("deletedAt")||(e+=1)}),e}}]),t}(Backbone.View);r["default"]=v,t.exports=r["default"]},{"../collections/groups":2,"../collections/users":3,"./user_item":13}]},{},[1]);